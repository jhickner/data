PRAGMA foreign_keys = ON;

CREATE TABLE data (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  ts TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  body TEXT NOT NULL
);
CREATE TABLE tag (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name VARCHAR(30) NOT NULL UNIQUE
);
CREATE TABLE tag_link (
  data_id INTEGER NOT NULL,
  tag_id INTEGER NOT NULL,
  FOREIGN KEY(data_id) REFERENCES data(id) ON DELETE CASCADE,
  FOREIGN KEY(tag_id) REFERENCES tag(id) ON DELETE CASCADE,
  PRIMARY KEY (data_id, tag_id)
);